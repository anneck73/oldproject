{#
    HTML5 Template !!!
    Shows a HomeMeal "Card"
#}
    {% trans_default_domain 'Mealmatch' %}

    {% spaceless %}
        <div class="modal-body">
            <div class="modal-img">
                <div class="modal-bg home-meal" ></div>
                <div class="centered">
                    <p class="modal-heading">{{ homeMeal.mealEvents.first.startDateTime|date('d. M') }}</p>
                    <div class="modal-cont-left"><p class="modal-con">{{ homeMeal.title|length > 45 ? homeMeal.title|slice(0, 45) ~ '...' : homeMeal.title }}</div>
                </div>
            </div>
            <div class="mealmatch-modal-content">
                <div class="row">
                    <div class="col-md-2">
                        <a href="{{ path('public_user_by_username', {'pName': homeMeal.host.username}) }}">
                            {% if homeMeal.host.profile.imageName == "image/udefault.png" %}
                                <img class="img-responsive"
                                     src="{{ asset('bundles/uipublic/images/mm/profilbild_default.png') }}"
                                     alt="Profileimage"/>
                            {% else %}
                                <img class="img-responsive" src="{{ asset(homeMeal.host.profile.imageName, 's3img') }}"
                                     alt="{{ homeMeal.host.username }}"/>
                            {% endif %}
                        </a>
                    </div>
                    <div class="col-md-10">
                        <p>#{{ homeMeal.categories|join(' #') }}</p>
                        <p>{{ homeMeal.description|raw }}</p>
                    </div>
                </div>

                <div class="row row-bg">
                    <div class="modal-inline">
                        <div class="col-md-2 col-xs-4 modal-servi">
                            <p><span class="fa fa-clock-o fa-2x"></span></p>
                            <p>{{ homeMeal.mealEvents.first.startDateTime|date('H:i') }}</p>
                        </div>
                        <div class="col-md-2 col-xs-4 modal-servi">
                            {% set currencySymbol = 'fa-euro' %}
                            {% if homeMeal.sharedCostCurrency == 'USD' %}
                                {% set currencySymbol = 'fa-usd' %}
                            {% endif %}
                            <div class="card-info">
                                <p><span class="fa {{ currencySymbol }} fa-2x "></span></p>
                                <p> {{ homeMeal.sharedCost|number_format(2) }}</p>
                            </div>
                        </div>
                        <div class="col-md-2 col-xs-4 modal-servi">
                            <p><span class="fa fa-map-marker fa-2x"></span></p>
                            <p>0,5 km</p>
                        </div><br/><br/><br/><br/><br/>
                        <div class="col-md-2 col-xs-4 modal-servi">

                            <p><span class="fa fa-calendar fa-2x"></span></p>
                            <p>{{ homeMeal.mealEvents.first.startDateTime|date('d.m.y') }}</p>
                        </div>
                        <div class="col-md-2 col-xs-4 modal-servi">

                            {% set guests =  homeMeal.guests|length %}
                            <p>{{ guests }}</p>
                            <p> {% transchoice guests with {'%count%': guests } from "Mealmatch" %}
                                    homemeal.manager.card.seats_taken{% endtranschoice %}
                            </p>
                        </div>
                        <div class="col-md-2 col-xs-4 modal-servi">
                            {% set freeSeats =  homeMeal.maxNumberOfGuest - homeMeal.guests.count %}
                            <p>{{ freeSeats }}</p>
                            <p> {% transchoice freeSeats with {'%count%': freeSeats } from "Mealmatch" %}
                                    homemeal.manager.card.seats_free{% endtranschoice %}
                            </p>
                        </div>
                    </div>
                </div><br/>

                <div class="row">
                    <div class="col-md-12">
                        <h3>{{ 'meal.guests'|trans }}</h3>
                        <div class="row modal-guest-row">
                            {% for guest in homeMeal.guests %}
                                <a href="{{ path('public_user_by_username', {'pName': guest.username}) }}" class="modal-guest">
                                    {% if guest.profile.imageName == "image/udefault.png" %}
                                        <img class="img-responsive"
                                             src="{{ asset('bundles/uipublic/images/mm/profilbild_default.png') }}"
                                             alt="Profileimage"/>
                                    {% else %}
                                        <img class="img-responsive"
                                             src="{{ asset(guest.profile.imageName, 's3img') }}"
                                             alt="Profileimage"/>
                                    {% endif %}
                                </a>
                            {% endfor %}
                        </div>
                    </div>
                </div><hr/>
                <div class="row">
                    <div class="col-md-12 text-center">
                        <span class="fa fa-map-marker fa-2x"></span>
                        <p>{{ homeMeal.host.profile.firstname }}, {{ homeMeal.host.profile.lastname }}</p>
                        {% if meal_service.isGuest(homeMeal, app.user) %}
                            <p>{{ homeMeal.address.streetName }} {{ homeMeal.address.streetNumber }}</p>
                        {% endif %}
                        <p>{{ homeMeal.address.postalCode }} {{ homeMeal.address.locality }}
                            - {{ homeMeal.address.sublocality }}</p>
                    </div>
                </div><hr/>

                <div class="modal-res-price">
                    <a href="{{ path('doTransitionBaseMeal', { 'id': homeMeal.id, 'transition': 'join_meal' }) }}">
                        <button class="btn btn-lg btn-success btn-block">
                            {{ 'meal.action.join'|trans }} {{ homeMeal.sharedCost|number_format(2) }} {{ homeMeal.sharedCostCurrency }}
                        </button>
                    </a>
                </div>
                <br>
                <div class="row">
                    <div class="text-center">
                        <img class="icon" src="{{ asset('bundles/uipublic/images/icons/soup.png') }}" height="48px" width="49px"/>
                        <img class="icon" src="{{ asset('bundles/uipublic/images/icons/soup.png') }}" height="48px" width="49px"/>
                        <img class="icon" src="{{ asset('bundles/uipublic/images/icons/soup.png') }}" height="48px" width="49px"/>
                    </div>
                </div>
            </div>
        </div>

    {% endspaceless %}
