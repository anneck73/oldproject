CREATE TABLE mm_restaurant_profile (id INT AUTO_INCREMENT NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE base_meal_guests (mmuser_id INT NOT NULL, base_meal_id INT NOT NULL, INDEX IDX_2B3EF7433AC9CBDC (mmuser_id), INDEX IDX_2B3EF7435790DFB2 (base_meal_id), PRIMARY KEY(mmuser_id, base_meal_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE same_address (id INT AUTO_INCREMENT NOT NULL, combined_location_string VARCHAR(255) NOT NULL, hash VARCHAR(255) NOT NULL, UNIQUE INDEX UNIQ_9792C62DD1B862B8 (hash), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE same_address_to_meal_address (meal_address_id INT NOT NULL, same_address_id INT NOT NULL, INDEX IDX_8F16D0E62DB19FF (meal_address_id), UNIQUE INDEX UNIQ_8F16D0ED57592B4 (same_address_id), PRIMARY KEY(meal_address_id, same_address_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE base_meal_category (id INT AUTO_INCREMENT NOT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, name VARCHAR(255) NOT NULL, description LONGTEXT NOT NULL, image VARCHAR(255) DEFAULT NULL, created_at DATETIME DEFAULT NULL, updated_at DATETIME DEFAULT NULL, UNIQUE INDEX UNIQ_EAE5370A5E237E06 (name), INDEX IDX_EAE5370AB03A8386 (created_by_id), INDEX IDX_EAE5370A896DBBDE (updated_by_id), INDEX IDX_EAE5370AC76F1F52 (deleted_by_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE base_meal (id INT AUTO_INCREMENT NOT NULL, host_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, title VARCHAR(255) NOT NULL, startDateTime DATETIME NOT NULL, maxGuest INT NOT NULL, description LONGTEXT DEFAULT NULL, sharedCost DOUBLE PRECISION NOT NULL, sharedCostCurrency VARCHAR(3) NOT NULL, status VARCHAR(12) NOT NULL, hash VARCHAR(255) NOT NULL, created_at DATETIME DEFAULT NULL, updated_at DATETIME DEFAULT NULL, meal_type VARCHAR(255) NOT NULL, UNIQUE INDEX UNIQ_895406CD1B862B8 (hash), INDEX IDX_895406C1FB8D185 (host_id), INDEX IDX_895406CB03A8386 (created_by_id), INDEX IDX_895406C896DBBDE (updated_by_id), INDEX IDX_895406CC76F1F52 (deleted_by_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE base_meal_to_category (base_meal_id INT NOT NULL, base_meal_category_id INT NOT NULL, INDEX IDX_F2E2EC425790DFB2 (base_meal_id), INDEX IDX_F2E2EC422BB1F6CF (base_meal_category_id), PRIMARY KEY(base_meal_id, base_meal_category_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE pro_meal_part (id INT AUTO_INCREMENT NOT NULL, pro_meal_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, title VARCHAR(255) NOT NULL, startDateTime DATETIME NOT NULL, maxGuest INT NOT NULL, description LONGTEXT DEFAULT NULL, sharedCost DOUBLE PRECISION NOT NULL, hash VARCHAR(255) NOT NULL, created_at DATETIME DEFAULT NULL, updated_at DATETIME DEFAULT NULL, UNIQUE INDEX UNIQ_431A2DCAD1B862B8 (hash), INDEX IDX_431A2DCA963FA00D (pro_meal_id), INDEX IDX_431A2DCAB03A8386 (created_by_id), INDEX IDX_431A2DCA896DBBDE (updated_by_id), INDEX IDX_431A2DCAC76F1F52 (deleted_by_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE home_meal (id INT NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE home_meal_to_meal_address (home_meal_id INT NOT NULL, meal_address_id INT NOT NULL, INDEX IDX_8016BE00D6B6AD8E (home_meal_id), INDEX IDX_8016BE0062DB19FF (meal_address_id), PRIMARY KEY(home_meal_id, meal_address_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE base_meal_part (id INT AUTO_INCREMENT NOT NULL, base_meal_id INT DEFAULT NULL, name VARCHAR(255) NOT NULL, description LONGTEXT NOT NULL, INDEX IDX_E0FD32BF5790DFB2 (base_meal_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE pro_meal (id INT NOT NULL, table_topic VARCHAR(255) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE pro_meal_to_meal_address (pro_meal_id INT NOT NULL, meal_address_id INT NOT NULL, INDEX IDX_910FFA8D963FA00D (pro_meal_id), INDEX IDX_910FFA8D62DB19FF (meal_address_id), PRIMARY KEY(pro_meal_id, meal_address_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE meal_address (id INT AUTO_INCREMENT NOT NULL, location_string VARCHAR(255) NOT NULL, country VARCHAR(255) DEFAULT NULL, countryCode VARCHAR(5) DEFAULT NULL, state VARCHAR(255) DEFAULT NULL, city VARCHAR(255) DEFAULT NULL, postalCode VARCHAR(255) DEFAULT NULL, streetName VARCHAR(255) DEFAULT NULL, streetNumber VARCHAR(255) DEFAULT NULL, extraLine1 VARCHAR(255) DEFAULT NULL, exraLine2 VARCHAR(255) DEFAULT NULL, locality VARCHAR(255) DEFAULT NULL, sublocality VARCHAR(255) DEFAULT NULL, description VARCHAR(255) DEFAULT NULL, bounds LONGTEXT DEFAULT NULL COMMENT '(DC2Type:array)', hash VARCHAR(255) NOT NULL, location POINT DEFAULT NULL COMMENT '(DC2Type:point)', sort INT NOT NULL, created_at DATETIME DEFAULT NULL, updated_at DATETIME DEFAULT NULL, UNIQUE INDEX UNIQ_74FDDD98D1B862B8 (hash), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE paypal_payment_token (id INT AUTO_INCREMENT NOT NULL, meal_ticket_id INT DEFAULT NULL, tokenReq LONGTEXT NOT NULL COMMENT '(DC2Type:json_array)', tokenResp LONGTEXT NOT NULL COMMENT '(DC2Type:json_array)', tokenError LONGTEXT NOT NULL COMMENT '(DC2Type:json_array)', tokenHash VARCHAR(255) NOT NULL, tokenKey VARCHAR(255) NOT NULL, tokenStatus VARCHAR(255) NOT NULL, INDEX IDX_CFD1C676CE6F45D9 (meal_ticket_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE base_meal_guests ADD CONSTRAINT FK_2B3EF7433AC9CBDC FOREIGN KEY (mmuser_id) REFERENCES mm_user (id) ON DELETE CASCADE;
ALTER TABLE base_meal_guests ADD CONSTRAINT FK_2B3EF7435790DFB2 FOREIGN KEY (base_meal_id) REFERENCES base_meal (id) ON DELETE CASCADE;
ALTER TABLE same_address_to_meal_address ADD CONSTRAINT FK_8F16D0E62DB19FF FOREIGN KEY (meal_address_id) REFERENCES same_address (id);
ALTER TABLE same_address_to_meal_address ADD CONSTRAINT FK_8F16D0ED57592B4 FOREIGN KEY (same_address_id) REFERENCES meal_address (id);
ALTER TABLE base_meal_category ADD CONSTRAINT FK_EAE5370AB03A8386 FOREIGN KEY (created_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE base_meal_category ADD CONSTRAINT FK_EAE5370A896DBBDE FOREIGN KEY (updated_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE base_meal_category ADD CONSTRAINT FK_EAE5370AC76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE base_meal ADD CONSTRAINT FK_895406C1FB8D185 FOREIGN KEY (host_id) REFERENCES mm_user (id);
ALTER TABLE base_meal ADD CONSTRAINT FK_895406CB03A8386 FOREIGN KEY (created_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE base_meal ADD CONSTRAINT FK_895406C896DBBDE FOREIGN KEY (updated_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE base_meal ADD CONSTRAINT FK_895406CC76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE base_meal_to_category ADD CONSTRAINT FK_F2E2EC425790DFB2 FOREIGN KEY (base_meal_id) REFERENCES base_meal (id) ON DELETE CASCADE;
ALTER TABLE base_meal_to_category ADD CONSTRAINT FK_F2E2EC422BB1F6CF FOREIGN KEY (base_meal_category_id) REFERENCES base_meal_category (id) ON DELETE CASCADE;
ALTER TABLE pro_meal_part ADD CONSTRAINT FK_431A2DCA963FA00D FOREIGN KEY (pro_meal_id) REFERENCES pro_meal (id);
ALTER TABLE pro_meal_part ADD CONSTRAINT FK_431A2DCAB03A8386 FOREIGN KEY (created_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE pro_meal_part ADD CONSTRAINT FK_431A2DCA896DBBDE FOREIGN KEY (updated_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE pro_meal_part ADD CONSTRAINT FK_431A2DCAC76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES mm_user (id) ON DELETE SET NULL;
ALTER TABLE home_meal ADD CONSTRAINT FK_BFD03F53BF396750 FOREIGN KEY (id) REFERENCES base_meal (id) ON DELETE CASCADE;
ALTER TABLE home_meal_to_meal_address ADD CONSTRAINT FK_8016BE00D6B6AD8E FOREIGN KEY (home_meal_id) REFERENCES home_meal (id);
ALTER TABLE home_meal_to_meal_address ADD CONSTRAINT FK_8016BE0062DB19FF FOREIGN KEY (meal_address_id) REFERENCES meal_address (id);
ALTER TABLE base_meal_part ADD CONSTRAINT FK_E0FD32BF5790DFB2 FOREIGN KEY (base_meal_id) REFERENCES base_meal (id);
ALTER TABLE pro_meal ADD CONSTRAINT FK_4ED63BEEBF396750 FOREIGN KEY (id) REFERENCES base_meal (id) ON DELETE CASCADE;
ALTER TABLE pro_meal_to_meal_address ADD CONSTRAINT FK_910FFA8D963FA00D FOREIGN KEY (pro_meal_id) REFERENCES pro_meal (id);
ALTER TABLE pro_meal_to_meal_address ADD CONSTRAINT FK_910FFA8D62DB19FF FOREIGN KEY (meal_address_id) REFERENCES meal_address (id);
ALTER TABLE paypal_payment_token ADD CONSTRAINT FK_CFD1C676CE6F45D9 FOREIGN KEY (meal_ticket_id) REFERENCES meal_ticket (id);
ALTER TABLE mm_user ADD restaurant_profile_id INT DEFAULT NULL, ADD created_at DATETIME DEFAULT NULL, ADD updated_at DATETIME DEFAULT NULL;
ALTER TABLE mm_user ADD CONSTRAINT FK_D5F3BF9069C03289 FOREIGN KEY (restaurant_profile_id) REFERENCES mm_restaurant_profile (id);
CREATE INDEX IDX_D5F3BF9069C03289 ON mm_user (restaurant_profile_id);
